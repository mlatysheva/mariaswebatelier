"use strict";(self.webpackChunkmaria_webatelier=self.webpackChunkmaria_webatelier||[]).push([[285],{8757:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Z});var r=n(5893),a=n(7294),i=n(2327),o=n(6461),c=n(3504),l=n(6974),s=n(5148),u=n(9021),d=n(4174);const f={CommentCard:"xIHByGcu",loading:"V0iZ1Un3"};var h=n(2794),m=n(1250),p=n(8746),v=function(){return v=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},v.apply(this,arguments)},g=function(e){var t=e.className,n=e.comment;return e.isLoading?(0,r.jsxs)(p.g,v({max:!0,gap:"8",align:"start",className:(0,c.A)(f.CommentCard,{},[t,f.loading])},{children:[(0,r.jsxs)(p.U,v({align:"center",gap:"8",max:!0},{children:[(0,r.jsx)(d.O,{width:30,height:30,border:"50%"}),(0,r.jsx)(d.O,{width:100,height:16})]})),(0,r.jsx)(d.O,{width:"100%",height:50})]})):n?(0,r.jsxs)(p.g,v({max:!0,align:"start",gap:"8",className:(0,c.A)(f.CommentCard,{},[t])},{children:[(0,r.jsxs)(h.F,v({to:"".concat(m.h3.profile).concat(n.user.id),className:f.header},{children:[(0,r.jsx)(u.q,{size:30,src:n.user.avatar}),(0,r.jsx)(s.xv,{title:n.user.username})]})),(0,r.jsx)(s.xv,{text:n.text})]})):null},x=function(){return x=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},x.apply(this,arguments)},b=function(e){var t=e.comments,n=e.isLoading,a=(0,i.$)().t;return n?(0,r.jsxs)(p.g,x({max:!0,align:"start"},{children:[(0,r.jsx)(g,{isLoading:!0}),(0,r.jsx)(g,{isLoading:!0}),(0,r.jsx)(g,{isLoading:!0})]})):(0,r.jsx)(p.g,x({max:!0,align:"start",gap:"16"},{children:(null==t?void 0:t.length)?t.map((function(e){return(0,r.jsx)(g,{isLoading:n,comment:e},e.id)})):(0,r.jsx)(s.xv,{text:a("no_comments")})}))},y=n(7310),w=n(9704),j=n(6244),k=n(2815),C=(0,a.lazy)((function(){return n.e(161).then(n.bind(n,8161))})),L=n(888);const S={ArticleDetailsPage:"adu8fSDx",commentTitle:"foyEsCeG",recommendations:"NwQlSikL"};var O=n(7168),P=(0,O.hg)("articleDetails/fetchCommentsByArticleId",(function(e,t){return n=void 0,r=void 0,i=function(){var n,r,a;return function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}(this,(function(i){switch(i.label){case 0:if(n=t.extra,r=t.rejectWithValue,!e)return[2,r("error")];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,n.api.get("/comments",{params:{articleId:e,_expand:"user"}})];case 2:if(!(a=i.sent()).data)throw new Error;return[2,a.data];case 3:return i.sent(),[2,r("Unable to fetch the comments")];case 4:return[2]}}))},new((a=void 0)||(a=Promise))((function(e,t){function o(e){try{l(i.next(e))}catch(e){t(e)}}function c(e){try{l(i.throw(e))}catch(e){t(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(o,c)}l((i=i.apply(n,r||[])).next())}));var n,r,a,i})),D=(0,O.HF)({selectId:function(e){return e.id}}),I=D.getSelectors((function(e){var t;return(null===(t=e.articleDetailsPage)||void 0===t?void 0:t.comments)||D.getInitialState()})),A=(0,O.oM)({name:"articleDetailsCommentsSlice",initialState:D.getInitialState({isLoading:!1,error:void 0,ids:[],entities:{}}),reducers:{},extraReducers:function(e){e.addCase(P.pending,(function(e){e.error=void 0,e.isLoading=!0})).addCase(P.fulfilled,(function(e,t){e.isLoading=!1,D.setAll(e,t.payload)})).addCase(P.rejected,(function(e,t){e.isLoading=!1,e.error=t.payload}))}}).reducer,N=function(e){var t,n;return null===(n=null===(t=e.articleDetailsPage)||void 0===t?void 0:t.comments)||void 0===n?void 0:n.isLoading},_=n(1856),T=n(2257),E=(0,O.hg)("articleDetails/addCommentForArticle",(function(e,t){return n=void 0,r=void 0,i=function(){var n,r,a,i,o,c,l;return function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}(this,(function(s){switch(s.label){case 0:if(n=t.extra,r=t.dispatch,a=t.rejectWithValue,i=t.getState,o=(0,_.m5)(i()),c=(0,T.wq)(i()),!o||!e||!c)return[2,a("Incorrect comment error")];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,n.api.post("/comments",{articleId:null==c?void 0:c.id,userId:null==o?void 0:o.id,text:e})];case 2:if(!(l=s.sent()).data)throw new Error;return r(P(c.id)),[2,l.data];case 3:return s.sent(),[2,a("Incorrect comment error")];case 4:return[2]}}))},new((a=void 0)||(a=Promise))((function(e,t){function o(e){try{l(i.next(e))}catch(e){t(e)}}function c(e){try{l(i.throw(e))}catch(e){t(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(o,c)}l((i=i.apply(n,r||[])).next())}));var n,r,a,i})),U=(0,O.hg)("articleDetailsPage/fetchArticleRecommendations",(function(e,t){return n=void 0,r=void 0,i=function(){var e,n,r;return function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}(this,(function(a){switch(a.label){case 0:e=t.extra,n=t.rejectWithValue,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,e.api.get("/articles",{params:{_expand:"user",_limit:4}})];case 2:if(!(r=a.sent()).data)throw new Error;return[2,r.data];case 3:return a.sent(),[2,n("Unable to fetch articles")];case 4:return[2]}}))},new((a=void 0)||(a=Promise))((function(e,t){function o(e){try{l(i.next(e))}catch(e){t(e)}}function c(e){try{l(i.throw(e))}catch(e){t(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(o,c)}l((i=i.apply(n,r||[])).next())}));var n,r,a,i})),z=(0,O.HF)({selectId:function(e){return e.id}}),G=z.getSelectors((function(e){var t;return(null===(t=e.articleDetailsPage)||void 0===t?void 0:t.recommendations)||z.getInitialState()})),H=(0,O.oM)({name:"articleDetailsRecommendationsSlice",initialState:z.getInitialState({isLoading:!1,error:void 0,ids:[],entities:{}}),reducers:{},extraReducers:function(e){e.addCase(U.pending,(function(e){e.error=void 0,e.isLoading=!0})).addCase(U.fulfilled,(function(e,t){e.isLoading=!1,z.setAll(e,t.payload)})).addCase(U.rejected,(function(e,t){e.isLoading=!1,e.error=t.payload}))}}).reducer,R=function(e){var t,n;return null===(n=null===(t=e.articleDetailsPage)||void 0===t?void 0:t.recommendations)||void 0===n?void 0:n.isLoading},q=(0,n(7779).UY)({comments:A,recommendations:H}),F=n(2503),V=(0,n(573).P1)(o.wq,_.m5,(function(e,t){return!(!e||!t)&&e.user.id===t.id})),W=function(){return W=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},W.apply(this,arguments)},$=function(){var e=(0,l.s0)(),t=(0,i.$)("article").t,n=(0,w.v9)(V),c=(0,w.v9)(o.wq),s=(0,a.useCallback)((function(){e(m.h3.articles)}),[e]),u=(0,a.useCallback)((function(){e("".concat(m.h3.article_details).concat(null==c?void 0:c.id,"/edit"))}),[e,null==c?void 0:c.id]);return(0,r.jsxs)(p.U,W({max:!0,gap:"16",justify:"between"},{children:[(0,r.jsx)(F.zx,W({theme:F.bn.OUTLINE,onClick:s},{children:t("back_to_articles")})),n&&(0,r.jsx)(F.zx,W({theme:F.bn.OUTLINE,onClick:u},{children:t("edit_article")}))]}))};const B=(0,a.memo)($);var M=function(){return M=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},M.apply(this,arguments)},Q={articleDetailsPage:q},Y=function(e){var t=e.className,n=(0,i.$)("article").t,u=(0,l.UO)().id,d=(0,w.v9)(I.selectAll),f=(0,w.v9)(N),h=(0,w.v9)(G.selectAll),m=(0,w.v9)(R),v=(0,k.T)(),g=(0,a.useCallback)((function(e){v(E(e))}),[v]);return(0,j.Q)((function(){v(P(u)),v(U())})),u?(0,r.jsx)(y.W,M({reducers:Q},{children:(0,r.jsx)(L.T,M({className:(0,c.A)(S.ArticleDetailsPage,{},[t])},{children:(0,r.jsxs)(p.g,M({gap:"16",max:!0,align:"start"},{children:[(0,r.jsx)(B,{}),(0,r.jsx)(o.D0,{id:u}),(0,r.jsx)(s.xv,{size:s.yH.L,className:S.commentTitle,title:n("recommendations")}),(0,r.jsx)(o.wD,{className:S.recommendations,articles:h,isLoading:m,target:"_blank"}),(0,r.jsx)(s.xv,{size:s.yH.L,className:S.commentTitle,title:n("comments")}),(0,r.jsx)(C,{onSendComment:g}),(0,r.jsx)(b,{isLoading:f,comments:d})]}))}))})):(0,r.jsx)(L.T,M({className:(0,c.A)(S.ARticleDetailsPage,{},[t])},{children:n("article_not_found")}))};const Z=(0,a.memo)(Y)}}]);